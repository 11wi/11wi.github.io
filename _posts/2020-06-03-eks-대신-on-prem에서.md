---
published: false
category: dev
---
원래 블로그의 취지는 기술적인 노하우를 정리하는 것이었으나 요즘은 하소연이 하고 싶은지 의식의 흐름대로 쓰게 되는구나.

드디어 추천/검색 플랫폼 개발 환경이 최종적으로 on premise k8s로 결정됐다. 이제 k8s 설치 업무마저 추가됐다. 일단 노후 장비 2대를 받았다. 그조차 2주를 기다려서...😂 연습 겸 네이버 클라우드 플랫폼(이하 ncp)에서 크레딧을 받고 여러번 테스트를 해봤다. 

테스트 해보니 먼저 제일 크게 느낀 점은 ncp가 괜히 싼 게 아니다! aws가 비싼 건 이유가 있다! 이건 말이 필요 없고 무료 크래딧으로 15분만 써봐도 느낌이 온다.

또 aks나 eks 같은 managed k8s 서비스가 엄청 편리하다는 걸 진심으로 느낀다. cluster가 생각보다 많은 걸 물고 있기 때문에 설치시 생각할 게 많다. 그리고 일부 소프트웨어나 하드웨어가 죽으면 어떻게 할지 생각하면 정말 막막하다. 

주요 lesson learnt은 1. `kubeadm`보다 `kubespray`가 훨씬 쓰기 좋다는 점. 그리고 2. HA cluster 구성을 위해선 cluster 내부에도 load balancer 및 networking 설정이 필요하다. 이를 위해 `haproxy + keepalived`를 쓴다는 점. 3. vip를 통해 물리 장비가 복수의 또는 고정된 ip를 만들 수 있다는 것. 아마 ec2 public ip도 이런 방식인 것 같다.

내일부터 본격적으로 설치하고 dns 등록하고 최종적으로 동작 확인까지 하는데 이번주면 끝나지 않을까 싶다.